--- ipsec-tools-0.8.0/src/racoon/ipsec_doi.c.orig	2013-11-24 07:30:20.096554364 +0100
+++ ipsec-tools-0.8.0/src/racoon/ipsec_doi.c	2013-11-24 07:30:34.196554870 +0100
@@ -1183,7 +1183,7 @@
 			"failed to get buffer.\n");
 		goto bad;
 	}
-	memset(pair, 0, sizeof(pair));
+	memset(pair, 0, MAXPROPPAIRLEN * sizeof(*pair));
 
 	bp = (caddr_t)(sab + 1);
 	tlen = sa->l - sizeof(*sab);
